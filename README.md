# C-学习之路

- [C-学习之路](#c-学习之路)
  - [C 程序结构](#c-程序结构)
    - [C Hello World 实例](#c-hello-world-实例)
    - [编译&执行C程序](#编译执行c程序)
  - [C 基本语法](#c-基本语法)
    - [C 的令牌（Token）](#c-的令牌token)
    - [分号 **;**](#分号-)
    - [注释](#注释)
    - [标识符](#标识符)
    - [关键字](#关键字)
      - [C99新增关键字](#c99新增关键字)
      - [C11新增关键字](#c11新增关键字)
    - [C中的空格](#c中的空格)
  - [C 数据类型](#c-数据类型)
    - [整数类型](#整数类型)
    - [浮点类型](#浮点类型)
    - [void类型](#void类型)
  - [C 变量](#c-变量)

## C 程序结构

### C Hello World 实例

C程序主要包括以下部分：

- 预处理器指令
- 函数
- 变量
- 语句&表达式
- 注释

现在看一段简单的代码，可以输出单词“Hello World”：

```c
#include <stdio.h>

int main() {
    /* 我的第一个C程序 */
    printf("Hello, World! \n");

    return 0;
}
```

接下来讲解一下这段程序：

1. 程序的第一行`#include <stdio.h>`是预处理器指令，高速C编译器在实际编译之前要包含stdio.h。
2. 下一行`int main()`是主函数，程序从这里开始执行。
3. 下一行`/*...*/`将会被编译器忽略，这里放置程序的注释内容。它们被称为程序的注释。
4. 下一行`printf("Hello, World! \n")`是C中另一个可用的函数，会在屏幕上显示信息“Hello，World！”。
5. 下一行`return 0`终止`main()`函数，并返回值0。

### 编译&执行C程序

接下来看看如何把源代码保存在一个文件中，以及如何编译并运行它。下面是简单的步骤：

1. 打开一个文本编辑器，添加上述代码。
2. 保存文件为[1-1.c](code\1-1.c)。
3. 打开终端，进入到保存文件所在的目录。
4. 键入`gcc 1-1.c`，输入回车，编译代码。
5. 如果代码中没有错误，命令提示符会跳到下一行，并生成[a.exe](code/a.exe)可执行文件。
6. 现在，键入[a.exe](code/a.exe)来执行程序。
7. 可以看到终端上显示“Hello，World!”。

![编译&运行](README_files/1.jpg)

请确保路径中已包含gcc编译器，并确保在包含源文件`1-1.c`的目录中运行它。  
如果是多个C代码的源码文件，编译方法如下：

> gcc test1.c test2.c -o main.exe  
./main.exe

`test1.c`与`test2.c`是两个源代码文件。

## C 基本语法

### C 的令牌（Token）

C程序由各种令牌组成，令牌可以是关键字、标识符、常量、字符串值，或者是一个符号。例如，下面的C语句包括五个令牌：

```c
printf("Hello, World! \n");
```

这五个令牌分别是：

```c
printf
(
  "Hello, World! \n"
)
;
```

### 分号 **;**

在C程序中，分号是语句结束符。也就是说，每个语句必须以分号结束。它表明一个逻辑实体的结束。  
例如，下面是两个不同的语句：

```c
printf("Hello, World! \n");
return 0;
```

### 注释

C语言有两种注释方式：

```c
// 单行注释
```

以`//`开始的单行注释，这种注释可以单独占一行。

```c
/* 单行注释 */
/*
  多行注释
  多行注释
  多行注释
 */
```

`/* */`这种格式的注释可以单行或者多行。  
不可以在注释内嵌套注释，注释也不能出现在字符串或者字符值中。

### 标识符

C标识符是用来标识变量、函数，或任何其他用户自定义项目的名称。一个标识符以字母`A-Z`或`a-z`或下划线`_`开始，后面跟零个或多个`字母`、`下划线`和`数字`（0-9）。  
C标识符内不允许出现标点字符，比如`@`、`$` 和 `%`。C 是区分大小写的编程语言。因此，在 C 中，`Manpower` 和 `manpower` 是两个不同的标识符。

### 关键字

下表列出了C中的保留字。这些保留字不能作为常量名、变量名或其他标识符名称。

|关键字|说明|
|--|--|
|auto|声明自动变量|
|break|跳出当前循环|
|case|开关语句分支|
|char|声明字符型变量或函数返回值类型|
|const|定义常量，如果一个变量被const修饰，那么它的值就不能再被改变|
|continue|结束当前循环，开始下一轮循环|
|default|开关语句中的“其他”分支
|do|循环语句的循环体|
|double|声明双精度浮点型变量或者函数返回值类型|
|else|条件语句否定分支（与if连用）|
|enum|声明枚举类型|
|extern|声明变量或函数是在其它文件或本文件的其他位置定义|
|float|声明浮点型变量或函数返回值类型|
|for|一种循环语句|
|goto|无条件跳转语句|
|if|条件语句|
|int|声明整型变量或函数|
|long|声明长整型变量或函数返回值类型|
|register|声明寄存器变量|
|return|子程序返回语句（可以带参数，也可不带参数）|
|short|声明短整型变量或函数|
|signed|声明有符号类型变量或函数|
|sizeof|计算数据类型或变量长度（即所占字节数）|
|static|声明静态变量|
|struct|声明结构体类型|
|switch|用于开关语句|
|typedef|用以给数据类型取别名|
|ungigned|声明无符号类型变量或函数|
|union|声明共用体类型|
|void|声明函数无返回值或无参数，声明无类型指针|
|volatile|说明变量在程序执行中可被隐含地改变|
|while|循环语句的循环条件|

#### C99新增关键字

|||||||
|--|--|--|--|--|--|
|_Bool|_Complex|_Imaginary|inline|restrict|

#### C11新增关键字

||||||||
|--|--|--|--|--|--|--|
|_Alignas|_Alignof|_Atomic|_Generic|_Noreturn|_Static_assert|_Thread_local|

### C中的空格

只包含空格的行，被称为空白行，可能带有注释，C编译器会完全忽视它。  
在C中，空格用于描述空白符、制表符、换行符和注释。空格分隔语句的各个部分，让编译器能识别语句中的某个元素（比如`int`）在哪里结束，下一个元素在哪里开始。因此，在下面的语句中：

```c
int age;
```

在这里，`int`和`age`之间必须至少有一个空白字符（通常是一个空白符），这样编译器才能够区分它们。另一个方面，在下面的语句中：

```c
fruit = apples + oranges; // 获取水果的总数
```

`fruit`和`=`，或者`=`和`apples`之间的空格字符不是必需的，但是为了增强可读性，可以根据需要适当增加一些空格。

## C 数据类型

在C语言中，数据类型指的是用于声明不同类型的变量或函数的一个广泛的系统。变量的类型决定了变量储存所占用的空间，以及如何解释存储的位模式。  
C中的类型可分为以下几种：

|序号|类型与描述|
|--|--|
|1| **基本类型：** 它们是算术类型，包括两种类型：整数类型和浮点数类型。|
|2| **枚举类型：** 它们也是算术类型，被用来定义在程序中只能赋予其一定的离散整数值的变量。|
|3| **void类型：** 类型说明符void表明没有可用的值。|
|4| **派生类型：** 它们包括：指针类型、数组类型、结构类型、共用体类型和函数类型。|

数组类型和结构类型统称为聚合类型。函数类型指的是函数返回值的类型。

### 整数类型

下表列出了关于标准整数类型的存储大小和值范围的细节：

|类型|存储大小|值范围|
|--|--|--|
|char|1字节|-128到127或0到255|
|unsigned char|1字节|0到255|
|signed char|1字节|-128到127|
|int|2或4字节|-32,768 到 32,767 或 -2,147,483,648 到 2,147,483,647|
|unsigned int|2或4字节|0 到 65,535 或 0 到 4,294,967,295|
|short|2字节|-32,768 到 32,767|
|unsigned short|2字节|0 到 65,535|
|long|4字节|-2,147,483,648 到 2,147,483,647|
|unsigned long|4字节|0 到 4,294,967,295|

**注意：** 各种类型的存储大小与系统位数有关，但目前通用的以64位系统为主。  
以下列出了32位系统与64位系统的存储大小的差别（window相同）：

![存储差别](README_files/2.jpg)

为了得到某个类型或某个变量在特定平台上的准确大小，可以使用`sizeof`运算符。表达式`sizeof(type)`得到对象或类型的存储字节大小。下面的实例演示了获取int类型的大小：

```c
#include <stdio.h>
#include <limits.h>

int main() {
    printf("int 存储大小：%lu \n", sizeof(int));

    return 0;
}
```

`%lu`为32位无符号整型。  
当在Window上编译并执行上面的程序时，输入命令：
> gcc -fexec-charset=gbk .\3-1.c -o 3-1.exe  
> .\3-1.exe

运行结果：
> int 存储大小：4

`-fexec-charset=`的作用是更改编码格式，默认是`utf-8`，在Window中更改编码为`gbk`，则不会出现中文乱码。

### 浮点类型

下表列出了关于标准浮点类型的存储大小、值范围和精度的细节：

|类型|存储大小|值范围|精度|
|--|--|--|--|
|float|4字节|1.2E-38 到 3.4E+38|6位有效位|
|double|8字节|2.3E-308 到 1.7E+308|15位有效位|
|long double|16字节|3.4E-4932 到 1.1E+4932|19位有效位|

头文件`float.h`定义了宏，在程序中可以使用这些值和其他有关实数二进制表示的细节。下面的实例将输出浮点类型占用的储存空间以及它的范围值：

```c
#include <stdio.h>
#include <float.h>

int main() {
    printf("float 存储最大字节数：%lu \n", sizeof(float));
    printf("float 最小值： %E \n", FLT_MIN);
    printf("float 最大值：%E\n", FLT_MAX);
    printf("精度值：%d\n", FLT_DIG);

    return 0;
}
```

`%E`表示以指数形式输出单、双精度实数。  
当在Window上编译并执行上面的程序时，运行结果：
> float 存储最大字节数：4  
float 最小值： 1.175494E-038  
float 最大值：3.402823E+038  
精度值：6

### void类型

void类型指定没有可用的值。它通常用于以下三种情况下：

|序号|类型与描述|
|--|--|
|1| **函数返回为空** C中有各种函数都不返回值，或者可以说它们返回空。不返回值的函数的返回类型为空。例如`void exit(int status);`|
|2| **函数参数为空** C中有各种函数不接受任何参数。不带参数的函数可以接受一个`void`。例如`int rand(void);`
|3| **指针指向void** 类型为`void *`的指针代表对象的地址，而不是类型。例如，内存分配函数`void *malloc(size_t size);`返回指向`void`的指针，可以转换为任何数据类型|

## C 变量

变量其实只不过是程序可操作的存储区的名称。C中每个变量都有特定的类型，类型决定了变量存储的大小和布局，该范围内的值都可以存储在内存中，运算符可应用于变量上。  
